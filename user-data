## template: jinja
#cloud-config
disable_root: false

disk_setup:
  swap:
    table_type: 'mbr'
    layout: false
    overwrite: true

fs_setup:
  - label: None,
    filesystem: swap
    device: swap
    partition: auto

packages:
  - python
  - openjdk-8-jdk
  - lsof
  - netcat
  - xinetd
  - zip

mounts:
  - [/dev/vdb, none, swap, sw, 0, 0 ]

bootcmd:
  - mkswap /dev/vdb
  - swapon /dev/vdb

ntp:
  enabled: true
  ntp_client: ntp

chpasswd:
  list: |
    root:$1$xyz$quBhc72d/1S/7c2IIRk7k1
  expire: False

manage_etc_hosts: True

apt_update: true

apt_upgrade: true

ssh_pwauth: True

users:
  - name: ubuntu
    ssh-authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCvIhS6cohahZN1aeld1EyzxNSdjKm7yE/P8EG0D9GEm0PUt7Z54K009dY+/9WPLzI8163CaPKS2X7XISUfyOpvGu9BrsYVrZtSnOuV9a79ztT6Xsy2w4ePSyvq/C/nuTp/1hv/WHhodoapeAevzhOmVQYU35ouwwg3e2HBB6KxIWMUX+LwyTWeZ4TVSn0OWobmsDjo3WsnapSsxUDFMPxRo70N8ntvdrSc9jhjufzkVtMo6Z6/SLWbuoLKaPByMMGxbpRQ7YK14Ymua42y/LEookYJRg0ZiW0s0DK9gpeNrJ+qvEL8MrJeg+/2QmF5gtuv6Jcyo8QTD6SVtBVBdr95 sandholm@beast4
    sudo: ['ALL=(ALL) NOPASSWD:ALL']
    shell: /bin/bash

runcmd:
  - echo '{{ ds.meta_data.role }}' > /etc/role
  - echo '{{ ds.meta_data.aenv }}' > /etc/aenv
  - update-grub
  - apt autoremove -y
  - touch /etc/cloud/cloud-init.disabled
  - eject
  - shutdown -h now
